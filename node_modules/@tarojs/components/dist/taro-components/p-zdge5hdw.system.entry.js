var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),a=0,t=0;t<r;t++)for(var n=arguments[t],u=0,o=n.length;u<o;u++,a++)i[a]=n[u];return i};System.register(["./p-faf4aa2e.system.js","./p-13196f99.system.js","./p-56448a04.system.js"],(function(e){"use strict";var t,r,i,a,n,u,o,s;return{setters:[function(e){t=e.r;r=e.h;i=e.c;a=e.H;n=e.g},function(e){u=e.c},function(e){o=e.T;s=e.L}],execute:function(){function h(e,t){var r=[];for(var i=e;i<=t;i++){r.push(""+(i<10?"0":"")+i)}return r}var l=__spreadArrays(["20","21","22","23"],h(0,23),["00","01","02","03"]);var c=__spreadArrays(["56","57","58","59"],h(0,59),["00","01","02","03"]);function d(e,t){if(!isNaN(+e)&&e>=0&&e<t.length)return true;return false}function f(e){if(!/^\d{1,2}:\d{1,2}$/.test(e))return false;var t=e.split(":").map((function(e){return+e}));if(t[0]<0||t[0]>23)return false;if(t[1]<0||t[1]>59)return false;return true}function g(e,t){var r=e.split(":").map((function(e){return+e}));var i=t.split(":").map((function(e){return+e}));if(r[0]<i[0])return true;if(r[0]===i[0]&&r[1]<=i[1])return true;return false}function p(e){if(!e)return false;var t=new Date(e.replace(/-/g,"/"));return isNaN(t.getMonth())?false:t}function v(e,t){if(t===4||t===6||t===9||t===11)return 30;if(t===2){if(e%4===0&&e%100!==0||e%400===0)return 29;else return 28}return 31}function m(e){var t;if(Array.isArray(e)){t=e.map((function(e){return String(e)}))}else{t=e}return t}function y(e,t){var r=[];for(var i=e;i<=t;i++){r.push(i)}return r}function k(e,t){return y(e,t)}function _(e,t,r){var i=1;var a=12;if(e.getFullYear()===r){i=e.getMonth()+1}if(t.getFullYear()===r){a=t.getMonth()+1}return y(i,a)}function C(e,t,r,i){var a=1;var n=v(r,i);if(e.getFullYear()===r&&e.getMonth()+1===i){a=e.getDate()}if(t.getFullYear()===r&&t.getMonth()+1===i){n=t.getDate()}return y(a,n)}var D=e("taro_picker_core",function(){function e(e){var a=this;t(this,e);this.index=[];this.mode="selector";this.disabled=false;this.range=[];this.start="";this.end="";this.fields="day";this.name="";this.pickerValue=[];this.height=[];this.hidden=true;this.fadeOut=false;this.showPicker=function(){if(a.disabled)return;a.height=a.getHeightByIndex();a.hidden=false};this.getHeightByIndex=function(){var e=a.index.map((function(e){var t=0;if(a.mode==="time"){t=s*4}return o-s*e-t}));return e};this.hidePicker=function(){a.fadeOut=true;setTimeout((function(){a.hidden=true;a.fadeOut=false}),350)};this.handleChange=function(){a.hidePicker();a.index=a.height.map((function(e){return(o-e)/s}));var e=a.index.length&&a.mode!=="selector"?a.index:a.index[0];if(a.mode==="time"){var t=[l.slice(),c.slice()];var r=a.index.map((function(e,r){return t[r][e]}));a.index=r.map((function(e){return parseInt(e)}));e=r.join(":")}if(a.mode==="date"){var i=a.pickerDate,n=i._start,u=i._end,h=i._updateValue;var d=h[0];var f=h[1];var g=k(n.getFullYear(),u.getFullYear());var p=_(n,u,d);var v=C(n,u,d,f);var m=g[a.index[0]];var y=p[a.index[1]];var D=v[a.index[2]];if(a.fields==="year"){e=[m]}else if(a.fields==="month"){e=[m,y]}else{e=[m,y,D]}e=e.join("-")}a.pickerValue=e;a.onChange.emit({value:e})};this.handleCancel=function(){a.hidePicker();a.onCancel.emit()};this.updateHeight=function(e,t,r){if(r===void 0){r=false}var i=__spreadArrays(a.height);i[t]=e;a.height=i;if(r){var n=a,u=n.start,h=n.end;if(!f(u))u="00:00";if(!f(h))h="23:59";if(!g(u,h))return;var d=[l.slice(),c.slice()];var p=a.height.map((function(e){return(o-e)/s}));var v=p.map((function(e,t){return d[t][e]})).join(":");if(!g(u,v)){var m=u.split(":").map((function(e){return o-s*(+e+4)}));requestAnimationFrame((function(){return a.height=m}))}else if(!g(v,h)){var y=h.split(":").map((function(e){return o-s*(+e+4)}));requestAnimationFrame((function(){return a.height=y}))}}};this.handleColumnChange=function(e,t){a.onColumnChange.emit({column:Number(t),value:(o-e)/s})};this.updateDay=function(e,t){var r=a.pickerDate,i=r._start,n=r._end,u=r._updateValue;u[t]=e;var h=u[0];var l=u[1];var c=u[2];if(t===0){var d=_(i,n,h);var f=d[d.length-1];var g=d[0];if(l>f)u[1]=f;if(l<g)u[1]=g;var p=d.indexOf(u[1]);var v=o-s*p;a.updateDay(u[1],1);a.updateHeight(v,"1")}else if(t===1){var m=C(i,n,h,l);var f=m[m.length-1];var g=m[0];if(c>f)u[2]=f;if(c<g)u[2]=g;var p=m.indexOf(u[2]);var v=o-s*p;a.updateDay(u[2],2);a.updateHeight(v,"2")}};this.getSelector=function(){return r("taro-picker-group",{range:a.range,rangeKey:a.rangeKey,height:a.height[0],updateHeight:a.updateHeight,columnId:"0"})};this.getMultiSelector=function(){return a.range.map((function(e,t){return r("taro-picker-group",{range:e,rangeKey:a.rangeKey,height:a.height[t],updateHeight:a.updateHeight,onColumnChange:a.handleColumnChange,columnId:String(t)})}))};this.getTimeSelector=function(){var e=l.slice();var t=c.slice();return[r("taro-picker-group",{mode:"time",range:e,height:a.height[0],updateHeight:a.updateHeight,columnId:"0"}),r("taro-picker-group",{mode:"time",range:t,height:a.height[1],updateHeight:a.updateHeight,columnId:"1"})]};this.getDateSelector=function(){var e=a,t=e.fields,i=e.height;var n=a.pickerDate,u=n._start,o=n._end,s=n._updateValue;var h=s[0];var l=s[1];var c=k(u.getFullYear(),o.getFullYear()).map((function(e){return e+"年"}));var d=_(u,o,h).map((function(e){return e+"月"}));var f=C(u,o,h,l).map((function(e){return e+"日"}));var g=[r("taro-picker-group",{mode:"date",range:c,height:i[0],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"0"})];if(t==="month"||t==="day"){g.push(r("taro-picker-group",{mode:"date",range:d,height:i[1],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"1"}))}if(t==="day"){g.push(r("taro-picker-group",{mode:"date",range:f,height:i[2],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"2"}))}return g};this.onChange=i(this,"change",7);this.onColumnChange=i(this,"columnchange",7);this.onCancel=i(this,"cancel",7)}e.prototype.componentWillLoad=function(){this.handleProps()};e.prototype.componentDidLoad=function(){var e=this;Object.defineProperty(this.el,"value",{get:function(){return e.pickerValue},set:function(t){return e.value=t},configurable:true})};e.prototype.onPropsChange=function(){this.handleProps()};e.prototype.handleProps=function(){var e=this;var t=this,r=t.mode,i=t.start,a=t.end;if(r==="selector"){var n=this.value;this.index=[d(n,this.range)?Math.floor(n):0]}else if(r==="multiSelector"){var u=this.value;this.index=[];this.range.forEach((function(t,r){var i;var a=(i=u)===null||i===void 0?void 0:i[r];var n=d(a,t)?Math.floor(a):0;e.index.push(n)}))}else if(r==="time"){var n=this.value;if(!f(n)){console.warn("time picker value illegal");n="0:0"}var o=n.split(":").map((function(e){return+e}));this.index=o}else if(r==="date"){var n=this.value;var s=p(n)||new Date((new Date).setHours(0,0,0,0));var h=p(i)||new Date("1970/01/01");var l=p(a)||new Date("2999/01/01");if(s>=h&&s<=l){var c=s.getFullYear();var g=s.getMonth()+1;var v=s.getDate();var m=k(h.getFullYear(),l.getFullYear());var y=_(h,l,c);var D=C(h,l,c,g);this.index=[m.indexOf(c),y.indexOf(g),D.indexOf(v)];if(!this.pickerDate||this.pickerDate._value.getTime()!==s.getTime()||this.pickerDate._start.getTime()!==h.getTime()||this.pickerDate._end.getTime()!==l.getTime()){this.pickerDate={_value:s,_start:h,_end:l,_updateValue:[c,g,v]}}}else{throw new Error("Date Interval Error")}}this.height=this.getHeightByIndex();this.pickerValue=this.value};e.prototype.render=function(){var e=this,t=e.name,i=e.mode,n=e.fadeOut,o=e.hidden;var s;switch(i){case"multiSelector":s=this.getMultiSelector();break;case"time":s=this.getTimeSelector();break;case"date":s=this.getDateSelector();break;default:s=this.getSelector()}var h=u("weui-mask","weui-animate-fade-in",{"weui-animate-fade-out":n});var l=u("weui-picker","weui-animate-slide-up",{"weui-animate-slide-down":n});var c=o?{display:"none"}:{};return r(a,null,r("div",{onClick:this.showPicker},r("slot",null)),r("div",{style:c,class:h,onClick:this.handleCancel}),r("div",{style:c,class:l},r("div",{class:"weui-picker__hd"},r("div",{class:"weui-picker__action",onClick:this.handleCancel},"取消"),r("div",{class:"weui-picker__action",onClick:this.handleChange},"确定")),r("div",{class:"weui-picker__bd"},s),r("input",{type:"hidden",name:t,value:m(this.pickerValue)})))};Object.defineProperty(e.prototype,"el",{get:function(){return n(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{mode:["onPropsChange"],value:["onPropsChange"],range:["onPropsChange"],start:["onPropsChange"],end:["onPropsChange"]}},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".weui-picker,.weui-picker__hd{font-size:12px}"},enumerable:true,configurable:true});return e}())}}}));