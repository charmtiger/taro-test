import{r as t,c as s,h as i,g as o}from"./p-fcde3f42.js";import{c as l}from"./p-cff38696.js";function r(t,s,i){if(t===s||"number"!=typeof t)return;const o=s-t,l=Date.now(),r=s>=t;!function h(){var c;c=Date.now()-l,t=o*c/500+t,r&&t>=s||!r&&s>=t?i(s):(i(t),requestAnimationFrame(h))}()}const h=class{constructor(i){t(this,i),this.scrollX=!1,this.scrollY=!1,this.upperThreshold=50,this.lowerThreshold=50,this.scrollWithAnimation=!1,this.handleScroll=()=>{const{scrollLeft:t,scrollTop:s,scrollHeight:i,scrollWidth:o}=this.container;this._scrollLeft=t,this._scrollTop=s,this.uperAndLower(),this.onScroll.emit({scrollLeft:t,scrollTop:s,scrollHeight:i,scrollWidth:o})},this.uperAndLower=function(t){let s;return function(...i){clearTimeout(s),s=setTimeout((function(){t(...i)}),200)}}(()=>{const{offsetWidth:t,offsetHeight:s,scrollLeft:i,scrollTop:o,scrollHeight:l,scrollWidth:r}=this.container,h=Number(this.lowerThreshold),c=Number(this.upperThreshold);!isNaN(h)&&(this.scrollY&&s+o+h>=l||this.scrollX&&t+i+h>=r)&&this.onScrollToLower.emit(),!isNaN(c)&&(this.scrollY&&o<=c||this.scrollX&&i<=c)&&this.onScrollToUpper.emit()}),this.onScroll=s(this,"scroll",7),this.onScrollToUpper=s(this,"scrolltoupper",7),this.onScrollToLower=s(this,"scrolltolower",7)}watchScrollLeft(t){const s=Number(t);this.scrollX&&!isNaN(s)&&s!==this._scrollLeft&&(this.scrollWithAnimation?r(this._scrollLeft,s,t=>this.container.scrollLeft=t):this.container.scrollLeft=s,this._scrollLeft=s)}watchScrollTop(t){const s=Number(t);this.scrollY&&!isNaN(s)&&s!==this._scrollTop&&(this.scrollWithAnimation?r(this._scrollTop,s,t=>this.container.scrollTop=t):this.container.scrollTop=s,this._scrollTop=s)}watchScrollIntoView(t){var s;"string"==typeof t&&t&&(null===(s=document.querySelector(`#${t}`))||void 0===s||s.scrollIntoView({behavior:"smooth",block:"center",inline:"start"}))}componentDidLoad(){const{scrollY:t,scrollX:s,scrollWithAnimation:i}=this,o=Number(this.mpScrollTop),l=Number(this.mpScrollLeft);t&&!isNaN(o)&&(i?r(0,o,t=>this.container.scrollTop=t):this.container.scrollTop=o,this._scrollTop=o),s&&!isNaN(l)&&(i?r(0,l,t=>this.container.scrollLeft=t):this.container.scrollLeft=l,this._scrollLeft=l)}render(){const{scrollX:t,scrollY:s}=this,o=l("taro-scroll",{"taro-scroll-view__scroll-x":t,"taro-scroll-view__scroll-y":s,[this.el.className]:this.el.className});return i("div",{class:o,ref:t=>this.container=t,onScroll:this.handleScroll},i("slot",null))}get el(){return o(this)}static get watchers(){return{mpScrollLeft:["watchScrollLeft"],mpScrollTop:["watchScrollTop"],mpScrollIntoView:["watchScrollIntoView"]}}static get style(){return".taro-scroll{-webkit-overflow-scrolling:auto}.taro-scroll::-webkit-scrollbar{display:none}.taro-scroll-view{overflow:hidden}.taro-scroll-view__scroll-x{overflow-x:scroll;overflow-y:hidden}.taro-scroll-view__scroll-y{overflow-x:hidden;overflow-y:scroll}"}};export{h as taro_scroll_view_core};