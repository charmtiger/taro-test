import{r as t,h as i,H as s}from"./p-fcde3f42.js";import{L as h,T as e,M as r}from"./p-d9e48de3.js";const n=class{constructor(i){t(this,i),this.range=[],this.onTouchStart=t=>{this.startY=t.changedTouches[0].clientY,this.preY=t.changedTouches[0].clientY,this.hadMove=!1},this.onTouchMove=t=>{t.preventDefault();const i=t.changedTouches[0].clientY,s=i-this.preY;this.preY=i,this.touchEnd=!1,Math.abs(i-this.startY)>10&&(this.hadMove=!0);let r=this.height+s;"time"===this.mode&&("0"===this.columnId?(r>e-3*h&&(r=e-27*h+s),r<e-28*h&&(r=e-4*h+s)):"1"===this.columnId&&(r>e-3*h&&(r=e-63*h+s),r<e-64*h&&(r=e-4*h+s))),this.updateHeight(r,this.columnId)},this.onTouchEnd=t=>{const{mode:i,range:s,height:n,updateHeight:o,onColumnChange:a,columnId:c}=this,u=-h*(s.length-1),d=t.changedTouches[0].clientY;let m;if(this.touchEnd=!0,this.hadMove)m=n-e;else{const t=window.innerHeight;if(m=n-e-(d-(t-r/2)),"time"===i)if("0"===c){if(m>2.5*-h)return this.formulaUnlimitedScroll(24,m,"up");if(m<28.5*-h)return this.formulaUnlimitedScroll(24,m,"down")}else if("1"===c){if(m>2.5*-h)return this.formulaUnlimitedScroll(60,m,"up");if(m<64.5*-h)return this.formulaUnlimitedScroll(60,m,"down")}}m>0&&(m=0),m<u&&(m=u);const l=Math.round(m/-h),p=e-h*l;"date"===this.mode&&("0"===this.columnId&&this.updateDay(+this.range[l].replace(/[^0-9]/gi,""),0),"1"===this.columnId&&this.updateDay(+this.range[l].replace(/[^0-9]/gi,""),1),"2"===this.columnId&&this.updateDay(+this.range[l].replace(/[^0-9]/gi,""),2)),o(p,c,"time"===i),a&&a(p,c)}}getPosition(){const t=`translate3d(0, ${this.height}px, 0)`,i=`transform ${this.touchEnd?.3:0}s`;return{transform:t,"-webkit-transform":t,transition:i,"-webkit-transition":i}}formulaUnlimitedScroll(t,i,s){const{height:r,updateHeight:n,columnId:o}=this,a="up"===s?1:-1;this.touchEnd=!1,n(-t*a*h+r,o),requestAnimationFrame(()=>{this.touchEnd=!0;const s=Math.round(i/-h)+t*a;n(e-h*s,o,!0)})}render(){const{range:t,rangeKey:h}=this,e=t.map(t=>i("div",{class:"weui-picker__item"},h?t[h]:t));return i(s,{class:"weui-picker__group",onTouchStart:this.onTouchStart,onTouchMove:this.onTouchMove,onTouchEnd:this.onTouchEnd},i("div",{class:"weui-picker__mask"}),i("div",{class:"weui-picker__indicator"}),i("div",{class:"weui-picker__content",style:this.getPosition()},e))}};export{n as taro_picker_group};